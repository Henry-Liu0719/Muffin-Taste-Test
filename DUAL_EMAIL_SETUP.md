# 🚀 雙重郵件功能設置說明

## ✨ 新功能：自動寄送測驗結果給客戶

您的瑪芬口味測驗現在具備**雙重郵件通知**功能！

### 📧 **雙重郵件機制**

1. **管理員通知郵件** → 寄送到 `hungminliu@gmail.com`
   - 通知有新測驗結果
   - 包含完整的用戶資訊和測驗結果
   - 用於追蹤和後續營銷

2. **客戶結果郵件** → 寄送到客戶填寫的信箱
   - 包含完整的測驗結果分析
   - 個人化的問候和建議
   - 包含社群和課程推廣連結

### 📋 **客戶郵件內容包括**

- 🎯 個人化的測驗結果
- 💬 角色台詞和特質描述
- ✨ 優勢分析和盲點提醒
- 💰 創收建議
- 📧 社群邀請連結
- 🎓 課程推廣資訊
- 📊 測驗完成時間

## 🔧 **設置步驟**

### 1. **更新 Google Apps Script**
- 將更新後的 `google-apps-script.js` 內容複製到您的 Apps Script 專案
- 確認 `SPREADSHEET_ID` 已正確設定
- 確認 `hungminliu@gmail.com` 是您要接收管理員通知的信箱

### 2. **重新部署 Web App**
- 在 Apps Script 中點擊「部署」→「管理部署」
- 選擇現有部署，點擊「編輯」
- 點擊「部署」按鈕
- 授權新的權限（如果需要）

### 3. **測試功能**
- 完成測驗並填寫信箱
- 檢查您的信箱是否收到管理員通知
- 檢查客戶信箱是否收到測驗結果

## 📊 **工作流程**

```
用戶完成測驗 → 填寫姓名和信箱 → 自動保存到試算表 → 
寄送管理員通知郵件 + 寄送客戶結果郵件 → 顯示結果頁面
```

## 🎯 **優勢**

1. **即時通知**：管理員立即收到新測驗結果通知
2. **客戶滿意度**：客戶自動收到完整的測驗結果
3. **營銷自動化**：自動推廣社群和課程
4. **數據追蹤**：完整的用戶參與記錄
5. **專業形象**：自動化的客戶服務體驗

## 🔍 **故障排除**

### 常見問題

**Q: 客戶沒有收到郵件**
A: 檢查客戶信箱是否正確填寫，確認垃圾郵件資料夾

**Q: 管理員沒有收到通知**
A: 檢查 Apps Script 執行記錄，確認郵件寄送是否成功

**Q: 郵件內容不完整**
A: 確認測驗數據是否正確傳遞到 Apps Script

### 測試方法

1. 在 Apps Script 編輯器中執行 `testFunction()` 函數
2. 檢查執行記錄中的郵件寄送狀態
3. 確認管理員和客戶信箱是否收到郵件

## 📧 **郵件範例**

### 管理員通知郵件
```
主旨：🎯 新的瑪芬口味測驗結果 - 爆漿檸檬瑪芬 - 創造者 Creator

🎉 有新的瑪芬口味測驗結果！

👤 用戶姓名：張小明
📧 用戶信箱：zhang@example.com
🎯 測驗結果：爆漿檸檬瑪芬 - 創造者 Creator
[更多內容...]
```

### 客戶結果郵件
```
主旨：🎯 您的瑪芬口味測驗結果 - 爆漿檸檬瑪芬 - 創造者 Creator

親愛的 張小明，您好！

🎉 恭喜您完成瑪芬口味測驗！

以下是您的專屬測驗結果：

🎯 您的瑪芬口味：爆漿檸檬瑪芬 - 創造者 Creator
💬 角色台詞：我有100個新點子等你聽！
[更多內容...]

💡 想要更深入了解如何運用這些特質來創造收入嗎？
[社群和課程推廣資訊...]
```

## 🔐 **權限設定**

確保您的 Google Apps Script 專案有以下權限：
- Google Sheets 存取權限
- Gmail 寄送郵件權限（包括寄送給外部信箱）
- 網頁應用程式部署權限

## 📈 **後續優化建議**

1. **郵件模板自訂**：可以根據不同測驗結果類型寄送不同內容
2. **多語言支援**：可以根據用戶語言偏好寄送對應語言
3. **郵件追蹤**：可以追蹤郵件開啟率和點擊率
4. **自動回覆**：可以設定自動回覆處理常見問題

## ⚠️ **注意事項**

1. **信箱驗證**：建議在客戶填寫信箱時進行格式驗證
2. **郵件頻率**：避免過於頻繁的郵件寄送
3. **退訂機制**：可以在郵件中加入退訂連結
4. **垃圾郵件**：建議客戶將您的信箱加入白名單

---

**重要提醒**：首次設置後，建議先測試郵件功能是否正常，確認無誤後再正式使用。同時，請確保遵守相關的電子郵件營銷法規。
