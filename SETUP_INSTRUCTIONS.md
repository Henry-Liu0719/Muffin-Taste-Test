# 瑪芬口味測驗結果保存功能設置說明

## 功能概述

您的瑪芬口味測驗現在具備以下新功能：

1. **📊 記錄到 Google 試算表** - 將測驗結果自動保存到 Google 試算表
2. **📧 寄送結果到信箱** - 自動準備郵件內容，開啟用戶的郵件客戶端
3. **📋 複製結果到剪貼簿** - 當郵件客戶端無法開啟時的備用方案

## 設置步驟

### 步驟 1：創建 Google 試算表

1. 前往 [Google 試算表](https://sheets.google.com/)
2. 創建一個新的試算表
3. 將試算表命名為「瑪芬口味測驗結果」
4. 複製試算表的 URL，從中提取 ID
   - URL 格式：`https://docs.google.com/spreadsheets/d/SPREADSHEET_ID/edit`
   - 複製 `SPREADSHEET_ID` 部分

### 步驟 2：創建 Google Apps Script

1. 前往 [Google Apps Script](https://script.google.com/)
2. 點擊「新專案」
3. 將專案命名為「瑪芬口味測驗結果處理器」
4. 刪除預設的程式碼，將 `google-apps-script.js` 的內容複製進去
5. 在 `SPREADSHEET_ID` 變數中替換為您的實際試算表 ID

### 步驟 3：部署為 Web App

1. 點擊「部署」→「新增部署」
2. 選擇「網頁應用程式」
3. 設定：
   - **執行身分**：選擇「我」
   - **存取權限**：選擇「任何人」
4. 點擊「部署」
5. 授權應用程式存取您的 Google 帳戶
6. 複製產生的 Web App URL

### 步驟 4：更新 JavaScript 程式碼

1. 在 `script.js` 中找到這行：
   ```javascript
   const scriptURL = 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL';
   ```
2. 將其替換為您的實際 Web App URL

## 功能說明

### 📊 Google 試算表記錄

- 自動創建「測驗結果」工作表
- 記錄完整的測驗結果，包括：
  - 測驗時間
  - 結果類型
  - 角色台詞
  - 特質描述
  - 優勢分析
  - 盲點提醒
  - 創收建議
  - 詳細分數
  - 系統記錄時間

### 📧 郵件寄送

- 自動準備格式化的郵件內容
- 使用 `mailto:` 連結開啟用戶的郵件客戶端
- 包含完整的測驗結果和建議

### 📋 剪貼簿複製

- 當郵件客戶端無法開啟時的備用方案
- 支援現代瀏覽器的 Clipboard API
- 提供降級方案以確保相容性

## 試算表欄位說明

| 欄位 | 說明 | 範例 |
|------|------|------|
| 測驗時間 | 用戶完成測驗的時間 | 2024/1/1 下午 12:00:00 |
| 結果類型 | 測驗結果的瑪芬類型 | 爆漿檸檬瑪芬 - 創造者 Creator |
| 角色台詞 | 對應角色的經典台詞 | 我有100個新點子等你聽！ |
| 特質 | 該類型的特質描述 | 靈感多、行動快、創意旺盛 |
| 優勢 | 該類型的優勢分析 | 開創新點子、啟動計畫 |
| 盲點提醒 | 該類型需要注意的盲點 | 常常虎頭蛇尾，需搭配執行者 |
| 創收建議 | 針對該類型的創收建議 | 快速啟動型事業，如新產品/課程設計 |
| 分數詳情 | 各維度的詳細分數 | {"Dynamo":5,"Blaze":2,"Tempo":2,"Steel":1} |
| 系統記錄時間 | 資料保存到試算表的時間 | 2024-01-01T04:00:00.000Z |

## 故障排除

### 常見問題

**Q: 點擊「記錄到 Google 試算表」按鈕沒有反應**
A: 檢查瀏覽器控制台是否有錯誤訊息，確認 Web App URL 是否正確

**Q: 保存失敗，顯示錯誤訊息**
A: 檢查 Apps Script 的執行權限，確認試算表 ID 是否正確

**Q: 郵件客戶端無法開啟**
A: 系統會自動顯示「複製結果到剪貼簿」按鈕作為備用方案

**Q: 試算表中沒有出現新數據**
A: 檢查 Apps Script 的執行記錄，確認是否有錯誤

### 測試方法

1. 在 Apps Script 編輯器中執行 `testFunction()` 函數
2. 檢查試算表是否出現測試數據
3. 在網頁上完成測驗，測試實際功能

## 進階功能

### 自動清理舊數據

可以設定定期執行 `cleanupOldData()` 函數來清理 30 天前的舊數據：

1. 在 Apps Script 中點擊「觸發器」
2. 新增觸發器，選擇 `cleanupOldData` 函數
3. 設定執行頻率（建議每月執行一次）

### 數據分析

試算表中的數據可以用於：
- 分析用戶偏好
- 追蹤測驗完成率
- 優化測驗內容
- 生成統計報告

## 安全性注意事項

- Web App 設定為「任何人」可存取，但只接受 POST 請求
- 建議定期檢查 Apps Script 的執行記錄
- 可以設定 IP 白名單來限制存取來源

## 技術支援

如果遇到技術問題，可以：
1. 檢查瀏覽器控制台的錯誤訊息
2. 查看 Apps Script 的執行記錄
3. 確認所有設定步驟是否正確完成

---

**注意**：首次設置可能需要一些時間，建議先在測試環境中驗證功能正常後再部署到正式環境。
